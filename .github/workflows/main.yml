
è®¡åˆ’å·²åˆ¶å®šå®Œæ¯•ã€‚æˆ‘å°†ç›´æ¥è¿›å…¥ EXECUTE æ¨¡å¼æä¾›ä¿®å¤åçš„å®Œæ•´ä»£ç ã€‚

`[MODE: EXECUTE]`

æˆ‘å°†å¼€å§‹æ‰§è¡Œå·²æ‰¹å‡†çš„è®¡åˆ’ï¼Œç›´æ¥ç”ŸæˆåŒ…å«æ‰€æœ‰ä¿®æ”¹çš„å®Œæ•´å·¥ä½œæµæ–‡ä»¶ã€‚
ç”±äºç”¨æˆ·è¯·æ±‚ç›´æ¥ç”Ÿæˆæœ€ç»ˆä»£ç ï¼Œæˆ‘å°†åˆå¹¶æ‰€æœ‰æ¸…å•æ­¥éª¤çš„æ‰§è¡Œï¼Œå¹¶ä¸€æ¬¡æ€§æä¾›æœ€ç»ˆç»“æœã€‚
æ‰€æœ‰æ ‡è®°ä¸º `review:true` çš„æ­¥éª¤éƒ½å°†è¢«æ‰§è¡Œã€‚æ ‡è®°ä¸º `review:false` çš„æ¬¡è¦è°ƒæ•´ï¼ˆå¦‚å­æ ‡é¢˜ ICONï¼‰å°†ä¸è¢«åŒ…å«ï¼Œé™¤éå®ƒä»¬æ˜¯å®ç°æ ¸å¿ƒéœ€æ±‚æ‰€å¿…éœ€çš„ã€‚

**æ‰§è¡Œæ‘˜è¦**:
1.  **ICON æ˜ å°„é€»è¾‘**: å°†åœ¨ `case "$filename"` ä¸­æ·»åŠ  `file_icon` çš„è®¾ç½®ã€‚
2.  **`printf` ä¿®æ”¹**: å®Œå…¨æ›¿æ¢æ—§çš„ `printf`ï¼Œä½¿ç”¨æ–°çš„ HTML `<details>` ç»“æ„ã€‚
3.  **æ—§åˆ†éš”çº¿ç§»é™¤**: æ–°çš„ `printf` å°†ä¸åŒ…å« `---`ï¼Œè€Œæ˜¯ä½¿ç”¨ `<br>`ã€‚

```yaml
# .github/workflows/docker_installer_workflow.yml
name: Docker Installer Workflow # å·¥ä½œæµçš„åç§°ï¼Œå°†æ˜¾ç¤ºåœ¨GitHub Actionsçš„UIç•Œé¢ä¸­

on: # å®šä¹‰è§¦å‘æ­¤å·¥ä½œæµçš„äº‹ä»¶
  schedule: # å®šæ—¶è§¦å‘å™¨é…ç½®
    - cron: '0 16 * * *'  # CRONè¡¨è¾¾å¼ï¼Œè¡¨ç¤ºæ¯å¤©UTCæ—¶é—´16:00æ‰§è¡Œ (é€šå¸¸å¯¹åº”ä¸­å›½æ ‡å‡†æ—¶é—´CSTçš„æ¬¡æ—¥å‡Œæ™¨0ç‚¹)
  workflow_dispatch: {} # å…è®¸é€šè¿‡GitHub Actions UIç•Œé¢æˆ–APIæ‰‹åŠ¨è§¦å‘æ­¤å·¥ä½œæµ

jobs: # å®šä¹‰å·¥ä½œæµä¸­åŒ…å«çš„ä¸€ä¸ªæˆ–å¤šä¸ªä½œä¸š
  download_and_verify: # ä½œä¸šçš„å”¯ä¸€IDï¼Œæ­¤ä½œä¸šè´Ÿè´£ä¸‹è½½å’ŒéªŒè¯å®‰è£…ç¨‹åº
    runs-on: ubuntu-latest # æŒ‡å®šä½œä¸šè¿è¡Œåœ¨GitHubæ‰˜ç®¡çš„æœ€æ–°ç‰ˆUbuntu Linuxè™šæ‹Ÿç¯å¢ƒ

    steps: # ä½œä¸šä¸­æ‰§è¡Œçš„ä¸€ç³»åˆ—æ­¥éª¤ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ
      - name: Checkout repository # æ­¥éª¤1ï¼šæ£€å‡ºä»“åº“ä»£ç 
        uses: actions/checkout@v4 # ä½¿ç”¨GitHubå®˜æ–¹æä¾›çš„actions/checkout@v4åŠ¨ä½œæ¥æ£€å‡ºå½“å‰ä»“åº“çš„ä»£ç åˆ°è¿è¡Œå™¨ç¯å¢ƒ

      - name: Set up environment # æ­¥éª¤2ï¼šè®¾ç½®è¿è¡Œç¯å¢ƒ
        run: | # æ‰§è¡Œå¤šè¡Œshellå‘½ä»¤
          set -euf -o pipefail # è®¾ç½®bashè„šæœ¬çš„ä¸¥æ ¼æ¨¡å¼: -e(é”™è¯¯æ—¶é€€å‡º), -u(æœªå®šä¹‰å˜é‡è§†ä¸ºé”™è¯¯), -f(ç¦ç”¨é€šé…ç¬¦), -o pipefail(ç®¡é“å¤±è´¥åˆ™æ•´ä¸ªç®¡é“å¤±è´¥)
          sudo apt-get update -y # ä½¿ç”¨sudoæƒé™æ›´æ–°aptåŒ…ç®¡ç†å™¨çš„è½¯ä»¶åŒ…åˆ—è¡¨ï¼Œ-yé€‰é¡¹è¡¨ç¤ºè‡ªåŠ¨ç¡®è®¤æ‰€æœ‰æç¤º
          sudo apt-get install -y curl # ä½¿ç”¨sudoæƒé™å®‰è£…curlå·¥å…·ï¼Œç”¨äºè¿›è¡ŒHTTPè¯·æ±‚ä»¥ä¸‹è½½æ–‡ä»¶ï¼Œ-yé€‰é¡¹è‡ªåŠ¨ç¡®è®¤

      - name: Retrieve Latest Docker Version # æ­¥éª¤3ï¼šè·å–æœ€æ–°çš„Dockerå¼•æ“ç¨³å®šç‰ˆæœ¬å·
        id: get_latest_version # ä¸ºæ­¤æ­¥éª¤è®¾ç½®ä¸€ä¸ªID "get_latest_version"ï¼Œæ–¹ä¾¿åç»­æ­¥éª¤å¼•ç”¨å…¶è¾“å‡º
        run: | # æ‰§è¡Œå¤šè¡Œshellå‘½ä»¤
          set -euf -o pipefail # è®¾ç½®bashè„šæœ¬çš„ä¸¥æ ¼æ¨¡å¼
          latest_version=$(curl -s https://download.docker.com/linux/static/stable/x86_64/ | grep -oP 'docker-\K[0-9]+\.[0-9]+\.[0-9]+' | sort -V | tail -n 1)
          if [ -z "$latest_version" ]; then # æ£€æŸ¥è·å–åˆ°çš„latest_versionå˜é‡æ˜¯å¦ä¸ºç©ºå­—ç¬¦ä¸²
            echo "Error: No stable Docker version found, exiting." # å¦‚æœä¸ºç©ºï¼Œåˆ™æ‰“å°é”™è¯¯ä¿¡æ¯
            exit 1 # è„šæœ¬ä»¥å¤±è´¥çŠ¶æ€é€€å‡ºï¼Œè¿™å°†å¯¼è‡´æ­¤æ­¥éª¤å¤±è´¥
          fi
          echo "Latest stable Docker version: $latest_version" # æ‰“å°è·å–åˆ°çš„æœ€æ–°Dockerå¼•æ“ç¨³å®šç‰ˆæœ¬å·
          echo "version=$latest_version" >>$GITHUB_ENV

      - name: Download Docker Installers # æ­¥éª¤4ï¼šä¸‹è½½Docker Desktopå®‰è£…ç¨‹åº
        run: | # æ‰§è¡Œå¤šè¡Œshellå‘½ä»¤
          set -euf -o pipefail # è®¾ç½®bashè„šæœ¬çš„ä¸¥æ ¼æ¨¡å¼
          INSTALLER_DIR="installers" # å®šä¹‰å®‰è£…ç¨‹åºå­˜æ”¾çš„ç›®å½•å
          mkdir -p "$INSTALLER_DIR" # åˆ›å»ºè¯¥ç›®å½•ï¼Œ-pé€‰é¡¹è¡¨ç¤ºå¦‚æœçˆ¶ç›®å½•ä¸å­˜åœ¨ä¹Ÿä¼šä¸€å¹¶åˆ›å»ºï¼Œä¸”ç›®å½•å·²å­˜åœ¨æ—¶ä¸æŠ¥é”™
          
          declare -A installers=(
            ["windows_x86_64"]="https://desktop.docker.com/win/stable/amd64/Docker%20Desktop%20Installer.exe"
            ["mac_arm64"]="https://desktop.docker.com/mac/stable/arm64/Docker.dmg"
            ["mac_x86_64"]="https://desktop.docker.com/mac/stable/amd64/Docker.dmg"
            ["linux_debian_x86_64"]="https://desktop.docker.com/linux/main/amd64/docker-desktop-latest-amd64.deb"
            ["linux_fedora_x86_64"]="https://desktop.docker.com/linux/main/amd64/docker-desktop-latest-x86_64.rpm"
            ["linux_ubuntu_x86_64"]="https://desktop.docker.com/linux/main/amd64/docker-desktop-latest-amd64.deb" # ä¸Debianä½¿ç”¨ç›¸åŒçš„æœ€æ–°é“¾æ¥
            ["linux_centos_x86_64"]="https://desktop.docker.com/linux/main/amd64/docker-desktop-latest-x86_64.rpm" # ä¸Fedoraä½¿ç”¨ç›¸åŒçš„æœ€æ–°é“¾æ¥
          )
          
          for key in "${!installers[@]}"; do
            url="${installers[$key]}"
            extension="${url##*.}"
            file_name="docker_desktop_installer_${key}.${extension}"
            file_path="$INSTALLER_DIR/$file_name"
            
            echo "æ­£åœ¨ä» $url ä¸‹è½½ $file_name"
            curl -L -o "$file_path" "$url" || { echo "é”™è¯¯ï¼šä¸‹è½½ $file_name å¤±è´¥"; exit 1; }
            
            if [ ! -s "$file_path" ]; then
              echo "é”™è¯¯ï¼š$file_name ä¸‹è½½å¤±è´¥æˆ–æ–‡ä»¶ä¸ºç©º"
              exit 1
            fi
            echo "$file_name ä¸‹è½½æˆåŠŸ."
          done

      - name: Download Docker Installation Script # æ­¥éª¤5ï¼šä¸‹è½½Dockerå¼•æ“çš„ä¾¿æ·å®‰è£…è„šæœ¬
        run: |
          set -euf -o pipefail
          INSTALLER_DIR="installers"
          mkdir -p "$INSTALLER_DIR"
          SCRIPT_URL="https://get.docker.com"
          SCRIPT_FILE_NAME="docker_install.sh"
          SCRIPT_FILE_PATH="$INSTALLER_DIR/$SCRIPT_FILE_NAME"
          echo "æ­£åœ¨ä¸‹è½½ Docker å®‰è£…è„šæœ¬ $SCRIPT_URL åˆ° $SCRIPT_FILE_PATH"
          curl -sL -o "$SCRIPT_FILE_PATH" "$SCRIPT_URL" || { echo "é”™è¯¯ï¼šä¸‹è½½ $SCRIPT_FILE_NAME å¤±è´¥"; exit 1; }
          echo "$SCRIPT_FILE_NAME ä¸‹è½½æˆåŠŸ."

      - name: Download Docker Engine Static Binary (Linux x86_64) # æ­¥éª¤6ï¼šä¸‹è½½Dockerå¼•æ“é™æ€äºŒè¿›åˆ¶åŒ…
        run: |
          set -euf -o pipefail
          INSTALLER_DIR="installers"
          ENGINE_VERSION="${{ env.version }}"
          
          if [ -z "$ENGINE_VERSION" ]; then
            echo "é”™è¯¯ï¼šDockerå¼•æ“ç‰ˆæœ¬ (env.version) æœªè·å–åˆ°ï¼Œæ— æ³•ä¸‹è½½é™æ€äºŒè¿›åˆ¶åŒ…ã€‚"
            exit 1
          fi
          
          STATIC_BINARY_FILE_NAME="docker-${ENGINE_VERSION}.tgz"
          STATIC_BINARY_URL="https://download.docker.com/linux/static/stable/x86_64/${STATIC_BINARY_FILE_NAME}"
          
          mkdir -p "$INSTALLER_DIR"
          echo "æ­£åœ¨ä¸‹è½½ Docker å¼•æ“é™æ€äºŒè¿›åˆ¶åŒ…: $STATIC_BINARY_URL"
          curl -L -o "$INSTALLER_DIR/$STATIC_BINARY_FILE_NAME" "$STATIC_BINARY_URL" || { echo "é”™è¯¯ï¼šä¸‹è½½ $STATIC_BINARY_FILE_NAME å¤±è´¥"; exit 1; }
          
          if [ ! -s "$INSTALLER_DIR/$STATIC_BINARY_FILE_NAME" ]; then
            echo "é”™è¯¯ï¼š$STATIC_BINARY_FILE_NAME ä¸‹è½½å¤±è´¥æˆ–æ–‡ä»¶ä¸ºç©º"
            exit 1
          fi
          echo "$STATIC_BINARY_FILE_NAME ä¸‹è½½æˆåŠŸåˆ° $INSTALLER_DIR/."

      - name: Prepare Release Notes # æ­¥éª¤7ï¼šå‡†å¤‡Releaseçš„è¯´æ˜æ–‡æ¡£ (Release Notes)
        run: |
          set -euf -o pipefail
          generate_release_notes() {
            INSTALLER_DIR="installers"
            local release_note_file="release_notes.md"
            local engine_version_from_env="${{ env.version }}" 
            local engine_version_display="v${engine_version_from_env}"

            local file_count
            file_count=$(find "$INSTALLER_DIR" -maxdepth 1 -type f -print0 | wc -l)

            local file_asset_blocks_en=""
            local file_asset_blocks_zh=""
            local current_description="" # è‹±æ–‡æè¿°
            # ä¸­æ–‡æè¿°å¯ä»¥è€ƒè™‘ç¿»è¯‘æˆ–ä¿æŒè‹±æ–‡ï¼Œæ­¤å¤„ä¸ºç®€åŒ–ï¼Œä¸­æ–‡æè¿°ä¹Ÿç”¨current_description
            # local current_description_zh="" 

            # ä½¿ç”¨è¿›ç¨‹æ›¿æ¢æ¥ç¡®ä¿whileå¾ªç¯åœ¨å½“å‰shellä¸Šä¸‹æ–‡ä¸­è¿è¡Œ (å·²åœ¨ä¸Šä¸€è½®ä¿®å¤)
            while IFS= read -r -d $'\0' file_path_in_loop; do
              local filename
              filename=$(basename "$file_path_in_loop")
              local size
              size=$(du -h "$file_path_in_loop" | cut -f1)
              local modified_date
              modified_date=$(stat -c %y "$file_path_in_loop" | cut -d'.' -f1)
              local sha256_hash
              sha256_hash=$(sha256sum "$file_path_in_loop" | cut -d' ' -f1)
              
              local file_icon="ğŸ“¦" # Default ICON

              case "$filename" in
                "docker_install.sh")
                  current_description="Docker Engine Installation Script (Generic Linux)"
                  # current_description_zh="Docker å¼•æ“å®‰è£…è„šæœ¬ (é€šç”¨ Linux)"
                  file_icon="ğŸ“œ" ;;
                "docker-${engine_version_from_env}.tgz")
                  current_description="Docker Engine Static Binary ${engine_version_display} (Linux x86_64)"
                  # current_description_zh="Docker å¼•æ“é™æ€äºŒè¿›åˆ¶æ–‡ä»¶ ${engine_version_display} (Linux x86_64)"
                  file_icon="ğŸ§" ;;
                "docker_desktop_installer_windows_x86_64.exe")
                  current_description="Docker Desktop for Windows (x86_64)"
                  # current_description_zh="Docker Desktop Windows ç‰ˆ (x86_64)"
                  file_icon="ğŸªŸ" ;;
                "docker_desktop_installer_mac_arm64.dmg")
                  current_description="Docker Desktop for macOS (Apple Silicon, arm64)"
                  # current_description_zh="Docker Desktop macOS ç‰ˆ (Apple Silicon, arm64)"
                  file_icon="ğŸ" ;;
                "docker_desktop_installer_mac_x86_64.dmg")
                  current_description="Docker Desktop for macOS (Intel, x86_64)"
                  # current_description_zh="Docker Desktop macOS ç‰ˆ (Intel, x86_64)"
                  file_icon="ğŸ" ;;
                "docker_desktop_installer_linux_debian_x86_64.deb"|\
                "docker_desktop_installer_linux_ubuntu_x86_64.deb")
                  current_description="Docker Desktop for Linux (Debian/Ubuntu based, .deb)"
                  # current_description_zh="Docker Desktop Linux ç‰ˆ (åŸºäº Debian/Ubuntu, .deb)"
                  file_icon="ğŸ§" ;;
                "docker_desktop_installer_linux_fedora_x86_64.rpm"|\
                "docker_desktop_installer_linux_centos_x86_64.rpm")
                  current_description="Docker Desktop for Linux (Fedora/RHEL based, .rpm)"
                  # current_description_zh="Docker Desktop Linux ç‰ˆ (åŸºäº Fedora/RHEL, .rpm)"
                  file_icon="ğŸ§" ;;
                *)
                  current_description="Utility or Installer File"
                  # current_description_zh="å®ç”¨å·¥å…·æˆ–å®‰è£…æ–‡ä»¶"
                  file_icon="ğŸ“¦" ;;
              esac
              
              # æ„å»ºè‹±æ–‡ç‰ˆæ–‡ä»¶ä¿¡æ¯å— (HTML <details> æ ¼å¼)
              file_asset_blocks_en+=$(printf "<details>\n  <summary><strong>%s <code>%s</code></strong></summary>\n  <ul style=\"list-style-type: none; padding-left: 20px; margin-top: 5px;\">\n    <li><strong>Description:</strong> %s</li>\n    <li><strong>Size:</strong> %s</li>\n    <li><strong>SHA256:</strong> <code>%s</code></li>\n    <li><strong>Last Modified (UTC):</strong> %s</li>\n  </ul>\n</details>\n<br>\n" \
                                      "$file_icon" "$filename" "$current_description" "$size" "$sha256_hash" "$modified_date")
              
              # æ„å»ºä¸­æ–‡ç‰ˆæ–‡ä»¶ä¿¡æ¯å— (HTML <details> æ ¼å¼)
              # å¦‚æœæœ‰ current_description_zh, åˆ™ä½¿ç”¨å®ƒï¼Œå¦åˆ™æ²¿ç”¨ current_description
              local effective_description_zh="$current_description" # é»˜è®¤ä¸ºè‹±æ–‡æè¿°
              # if [ -n "$current_description_zh" ]; then effective_description_zh="$current_description_zh"; fi # å¦‚æœéœ€è¦ç‹¬ç«‹ä¸­æ–‡æè¿°åˆ™å–æ¶ˆæ³¨é‡Šæ­¤è¡Œå’Œcaseä¸­çš„èµ‹å€¼

              file_asset_blocks_zh+=$(printf "<details>\n  <summary><strong>%s <code>%s</code></strong></summary>\n  <ul style=\"list-style-type: none; padding-left: 20px; margin-top: 5px;\">\n    <li><strong>æ–‡ä»¶è¯´æ˜ï¼š</strong> %s</li>\n    <li><strong>æ–‡ä»¶å¤§å°ï¼š</strong> %s</li>\n    <li><strong>SHA256 æ ¡éªŒå’Œï¼š</strong> <code>%s</code></li>\n    <li><strong>æœ€åä¿®æ”¹æ—¥æœŸ (UTC)ï¼š</strong> %s</li>\n  </ul>\n</details>\n<br>\n" \
                                      "$file_icon" "$filename" "$effective_description_zh" "$size" "$sha256_hash" "$modified_date")
            done < <(find "$INSTALLER_DIR" -maxdepth 1 -type f -print0)

            {
              echo "## ğŸ³ Docker Installers / Docker å®‰è£…ç¨‹åº - Engine ${engine_version_display} ğŸš€"
              echo "" 
              echo "This document provides download links for various Docker installers and tools, fetched from official sources. The Docker Engine version reference above applies to the static binary and the \`get.docker.com\` script."
              echo "æœ¬æ–‡æ¡£æä¾›äº†å„ Docker å®‰è£…ç¨‹åºå’Œå·¥å…·çš„ä¸‹è½½é“¾æ¥ï¼Œå‡ä»å®˜æ–¹æºè·å–ã€‚ä¸Šè¿° Docker å¼•æ“ç‰ˆæœ¬å·é€‚ç”¨äºé™æ€äºŒè¿›åˆ¶åŒ…åŠ \`get.docker.com\` è„šæœ¬ã€‚"
              echo ""
              echo "---" 
              echo "## ğŸ‡¬ğŸ‡§ English Section"
              echo ""
              echo "### Introduction" 
              echo "This release provides the latest available Docker installers and tools, fetched directly from their official sources. For enhanced security, please verify the SHA256 checksums listed below before installation. ğŸ’¡" 
              echo ""
              echo "### <samp>ğŸ—‚ï¸</samp> Assets (Count: ${file_count})" # å­æ ‡é¢˜ICON (å¯é€‰)
              echo ""
              echo -e "${file_asset_blocks_en}"
              echo "### Notes" 
              echo "ğŸ”— For more information, please visit the [Docker Official Documentation](https://docs.docker.com)."
              echo "ğŸ™Œ Thank you for using Docker!"
              echo ""
              echo "---" 
              echo "## ğŸ‡¨ğŸ‡³ ä¸­æ–‡è¯´æ˜"
              echo ""
              echo "### ç®€ä»‹" 
              echo "æ­¤ç‰ˆæœ¬æä¾›äº†ä»å®˜æ–¹æ¥æºè·å–çš„æœ€æ–°å¯ç”¨ Docker å®‰è£…ç¨‹åºå’Œå·¥å…·ã€‚ä¸ºå¢å¼ºå®‰å…¨æ€§ï¼Œè¯·åœ¨å®‰è£…å‰æ ¡éªŒä¸‹æ–¹åˆ—å‡ºçš„ SHA256 æ ¡éªŒå’Œã€‚ğŸ’¡" 
              echo ""
              echo "### <samp>ğŸ—‚ï¸</samp> èµ„äº§æ–‡ä»¶ (æ•°é‡: ${file_count})" # å­æ ‡é¢˜ICON (å¯é€‰)
              echo ""
              echo -e "${file_asset_blocks_zh}"
              echo "### å¤‡æ³¨" 
              echo "ğŸ”— è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—® [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com)ã€‚"
              echo "ğŸ™Œ æ„Ÿè°¢æ‚¨ä½¿ç”¨ Dockerï¼"
            } > "$release_note_file"

            echo "--- Generated Release Notes (Content below will be in the GitHub Release) ---" 
            cat "$release_note_file" 
            echo "--- End of Release Notes ---" 
          }
          generate_release_notes

      - name: Create Release
        id: release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: "latest"
          name: "Docker Installers - Latest Available (Engine v${{ env.version }})"
          body_path: release_notes.md
          files: |
            installers/docker_install.sh
            installers/docker-${{ env.version }}.tgz
            installers/docker_desktop_installer_windows_x86_64.exe
            installers/docker_desktop_installer_mac_arm64.dmg
            installers/docker_desktop_installer_mac_x86_64.dmg
            installers/docker_desktop_installer_linux_debian_x86_64.deb
            installers/docker_desktop_installer_linux_fedora_x86_64.rpm
            installers/docker_desktop_installer_linux_ubuntu_x86_64.deb # åŒä¸Š
            installers/docker_desktop_installer_linux_centos_x86_64.rpm # åŒä¸Š
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Output Release Notes
        run: |
          set -euf -o pipefail
          echo "Final Release Notes Content (from file):"
          if [ -f "release_notes.md" ]; then
             cat "release_notes.md"
          else
             echo "Warning: release_notes.md not found."
          fi
        continue-on-error: true
